import requests
import re

url = 'https://lakatamia.tv/app/chans/gr/stargr.php with the embedded code for the STAR/'
response = requests.get(url)

stream_name = "STAR"

if response.status_code != 200:
    print('Scraper error: ' + str(response.status_code))
    exit()

page = response.text

regex = r'token=(.*?)"'
match = re.search(regex, page)

if match:
    stream_url = f"https://s2.cystream.net/galanos/star/playlist.m3u8?wmsAuthSign=c2VydmVyX3RpbWU9MTAvOC8yMDI1IDM6NDU6NTAgUE0maGFzaF92YWx1ZT1wR3RDaDJQajZ2aDllbVhndCt1dUlnPT0mdmFsaWRtaW51dGVzPTIw{match.group(1)}"
else:
    stream_url = "error"

print('Content-Type: application/octet-stream')
print("#EXTM3U")
print(f"#EXTINF:-1,{stream_name}")
print(stream_url)
